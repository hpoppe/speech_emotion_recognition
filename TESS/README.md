# TESS Emotion Recognition

This directory contains the experimental setup for the **Toronto Emotional Speech Set (TESS)**. It includes scripts for data preprocessing, feature extraction, and model training using various deep learning architectures.

## Directory Structure

-   **`Architecture/`**: Contains the PyTorch model definitions.
    -   `cnnmodel1.py`: 1D CNN with 3 convolutional blocks.
    -   `cnnmodel2.py`: 1D CNN with SELU activations and strided pooling.
    -   `cnntcn.py`: Hybrid 2D CNN + Temporal Convolutional Network (TCN).
    -   `lstmcnn.py`: Hybrid LSTM + 1D CNN.
    -   `transformerencoder.py`: Transformer Encoder with global max pooling.
-   **`Dataset/`**: Stores the processed HDF5 datasets (generated by the preprocessing notebook).
-   **`Preprocessing_Feature_Extraction/`**: Contains the Jupyter notebook for data processing.
    -   `data_preprocess_TESS.ipynb`: Handles data loading, cleaning, feature extraction (Mel Spectrograms + MFCCs), and dataset creation.
-   **`Training/`**: Stores training logs and checkpoints.

## Prerequisites

Ensure you have the necessary Python packages installed. You can install them using the `requirements.txt` file in the parent directory:

```bash
pip install -r ../requirements.txt
```

## Usage

### 1. Data Preprocessing

Before training, you need to generate the datasets.

1.  Open the notebook: `Preprocessing_Feature_Extraction/data_preprocess_TESS.ipynb`
2.  Run all cells to process the audio files and generate the HDF5 datasets.
3.  The datasets (`train_TESS_mel_mfcc.h5`, `valid_TESS_mel_mfcc.h5`, `test_TESS_mel_mfcc.h5`) will be saved in the `Dataset/` directory.

### 2. Model Training

To start training the model, run the `train_TESS.py` script:

```bash
python train_TESS.py
```

**Configuration:**
-   **Model Selection**: By default, the script uses `cnnmodel1`. To use a different model, modify line 24 (`from Architecture import ...`) and line 377 (`self.model = ...`) in `train_TESS.py`.
-   **Device**: The script defaults to `mps` (Metal Performance Shaders) for macOS. If you are using CUDA or CPU, update line 346 (`self.device = ...`).
-   **Hyperparameters**: You can adjust epochs, batch size, and learning rate in the `execute` method of `train_TESS.py`.

### 3. Results

-   **Logs**: Training logs (TensorBoard) are saved in `Training/<timestamp>/`.
-   **Checkpoints**: The best model is saved as `best_model.pt` and `time_<timestamp>.pt`.
-   **Evaluation**: A confusion matrix (`confusion_matrix.png`) and a text report with metrics are generated after training.
